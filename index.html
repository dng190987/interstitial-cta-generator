<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Interstitial CTA Generator</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    body{margin:0;font-family:Inter,sans-serif;background:linear-gradient(135deg,#020617,#0f172a);color:#e5e7eb}
    .container{display:grid;grid-template-columns:400px 1fr;min-height:100vh}
    .panel{padding:28px;background:rgba(255,255,255,.04);backdrop-filter:blur(12px)}
    h1{font-size:1.4rem;margin-bottom:10px}
    label{font-size:.8rem;margin-top:14px;display:block}
    input,textarea{width:100%;margin-top:6px;padding:10px 12px;border-radius:10px;border:none;background:#020617;color:#e5e7eb}
    button{width:100%;margin-top:18px;padding:12px;border-radius:12px;border:none;background:linear-gradient(135deg,#38bdf8,#6366f1);color:#020617;font-weight:700;cursor:pointer}
    .preview{display:flex;align-items:center;justify-content:center}
    .card{background:#020617;padding:32px;border-radius:20px;width:360px;text-align:center;box-shadow:0 30px 60px rgba(0,0,0,.6)}
    .card img{width:100%;border-radius:14px;margin-bottom:14px}
    .card a{display:block;margin-top:16px;padding:12px;background:linear-gradient(135deg,#fbbf24,#f97316);border-radius:14px;color:#020617;font-weight:700;text-decoration:none;cursor:pointer}
    .skip{font-size:.75rem;margin-top:10px;opacity:.7;cursor:pointer}
    .code-box{background:#020617;padding:14px;border-radius:12px;font-size:.75rem;margin-top:16px;white-space:pre-wrap;position:relative}
    .copy{position:absolute;top:10px;right:10px;cursor:pointer;font-size:.9rem;opacity:.8}
  </style>
</head>
<body>
<div class="container">
  <div class="panel">
    <h1>Interstitial CTA Generator</h1>

    <label>Target URL (Skip / Auto redirect)</label>
    <input id="target" placeholder="https://target-website.com" />

    <label>Affiliate / Button URL</label>
    <input id="btnUrl" placeholder="https://affiliate-link.com" />

    <label>Headline</label>
    <input id="headline" placeholder="Exclusive Deal Inside" />

    <label>Description</label>
    <textarea id="desc" rows="3" placeholder="Limited-time offer available"></textarea>

    <label>Button Text</label>
    <input id="btnText" placeholder="Get Offer" />

    <label>Upload Image (optional)</label>
    <input type="file" id="imgFile" accept="image/*" />

    <label>Auto Redirect Seconds (â†’ Target URL)</label>
    <input id="timer" placeholder="5" />

    <button onclick="generate()">Generate Interstitial Link</button>

    <div class="code-box" id="linkBox">
      <span class="copy" onclick="copyLink()">ðŸ“‹</span>
    </div>
  </div>

  <div class="preview" id="preview"></div>
</div>

<script>
function uid(){return Math.random().toString(36).slice(2,10)}
let uploadedImg='';

imgFile.addEventListener('change',e=>{
  const f=e.target.files[0]; if(!f) return;
  const r=new FileReader();
  r.onload=()=>uploadedImg=r.result;
  r.readAsDataURL(f);
});

function generate(){
  const id = uid();
  const data = {
    target: target.value.trim(),
    btnUrl: btnUrl.value.trim(),
    headline: headline.value,
    desc: desc.value,
    btnText: btnText.value,
    img: uploadedImg,
    timer: Number(timer.value) || 0,
    views: 0,
    clicks: 0
  };

  if(!data.target || !data.btnUrl){
    alert('Please enter both Target URL and Button URL');
    return;
  }

  localStorage.setItem(id, JSON.stringify(data));

  const base = window.location.origin + window.location.pathname;
  const link = base + '#' + id;

  linkBox.innerHTML = `<span class="copy" onclick="copyLink()">ðŸ“‹</span>${link}`;
  renderPreview(data);
}

function renderPreview(d){
  preview.innerHTML = `
  <div class="card">
    ${d.img ? `<img src="${d.img}">` : ''}
    <h2>${d.headline}</h2>
    <p>${d.desc}</p>
    <a>${d.btnText}</a>
    <div class="skip">Skip & continue</div>
  </div>`;
}

function copyLink(){
  const m = linkBox.innerText.match(/https?:\/\/\S+/);
  if(m) navigator.clipboard.writeText(m[0]);
}

/* ================= RUNTIME MODE ================= */
if(location.hash){
  const id = location.hash.slice(1);
  const d = JSON.parse(localStorage.getItem(id));
  if(!d) return;

  d.views++;
  localStorage.setItem(id, JSON.stringify(d));

  document.body.innerHTML = `
    <div class="preview">
      <div class="card">
        ${d.img ? `<img src="${d.img}">` : ''}
        <h2>${d.headline}</h2>
        <p>${d.desc}</p>
        <a id="ctaBtn">${d.btnText}</a>
        <div class="skip" id="skipBtn">Skip & continue</div>
      </div>
    </div>`;

  // CTA BUTTON â†’ AFFILIATE URL
  document.getElementById('ctaBtn').addEventListener('click', ()=>{
    d.clicks++;
    localStorage.setItem(id, JSON.stringify(d));
    window.location.href = d.btnUrl;
  });

  // SKIP â†’ TARGET URL
  const goTarget = ()=>{ window.location.href = d.target; };
  document.getElementById('skipBtn').addEventListener('click', goTarget);

  // AUTO REDIRECT â†’ TARGET URL
  if(d.timer > 0){
    setTimeout(goTarget, d.timer * 1000);
  }
}
</script>
</body>
</html>
